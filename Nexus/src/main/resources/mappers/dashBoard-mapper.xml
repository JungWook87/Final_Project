<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="dashBoardMapper">


	<resultMap type="attnDoughnut" id="attnDoughnut_rm">
		<id property="typeNo"  column="TYPE_NO"/>
		<result property="typeName" column="ATTN_TYPE_NAME"/>	
		<result property="typeCount" column="COUNT"/>			
	</resultMap>



	<select id="doughnutList" parameterType="_int" resultMap="attnDoughnut_rm">
		SELECT ATTD_TYPE_NO AS TYPE_NO, ATTD_TYPE_NAME, COUNT(*) AS COUNT
		FROM ATTENDANCE
		JOIN ATTD_TYPE USING (ATTD_TYPE_NO)
		JOIN "MEMBER" USING (MEM_NO)
		WHERE DEPT_NO = #{deptNo}
		AND TODAY = TO_CHAR(SYSDATE, 'YY/MM/DD')
		GROUP BY ATTD_TYPE_NO, ATTD_TYPE_NAME
		ORDER BY ATTD_TYPE_NO ASC;	
	</select>

</mapper>
